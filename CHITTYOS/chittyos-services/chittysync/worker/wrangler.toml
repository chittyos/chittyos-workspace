name = "chittysync-hub"
main = "src/index.ts"
compatibility_date = "2024-10-11"
compatibility_flags = ["nodejs_compat"]
account_id = "0bc21e3a5a9de1a4cc843be9c3e98121"

# Development/default configuration
[vars]
SERVICE_NAME = "chittysync-hub"
SERVICE_VERSION = "1.0.0"
CHITTYOS_ENVIRONMENT = "development"
CHITTYID_SERVICE_URL = "https://id.chitty.cc/v1"
GATEWAY_SERVICE_URL = "https://gateway.chitty.cc"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "chittyos-todos"
database_id = "edb47ac4-debf-456d-a963-c90fb05f5960"

# Production environment
[env.production]
name = "chittysync-hub-production"
vars = { SERVICE_NAME = "chittysync-hub", SERVICE_VERSION = "1.0.0", CHITTYOS_ENVIRONMENT = "production", CHITTYID_SERVICE_URL = "https://id.chitty.cc/v1", GATEWAY_SERVICE_URL = "https://gateway.chitty.cc" }

[[env.production.d1_databases]]
binding = "DB"
database_name = "chittyos-todos"
database_id = "edb47ac4-debf-456d-a963-c90fb05f5960"

# Route configuration - via ChittyGateway API path (requires auth)
[[env.production.routes]]
pattern = "gateway.chitty.cc/api/todos/*"
zone_name = "chitty.cc"

[[env.production.routes]]
pattern = "gateway.chitty.cc/api/memory/*"
zone_name = "chitty.cc"

[[env.production.routes]]
pattern = "gateway.chitty.cc/api/directions/*"
zone_name = "chitty.cc"

# Observability
[observability]
enabled = true
