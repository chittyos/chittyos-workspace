server {
    listen 80;
    server_name schema.chitty.cc;
    root /var/www/schema.chitty.cc;

    # CORS headers
    add_header Access-Control-Allow-Origin "*" always;
    add_header Access-Control-Allow-Methods "GET, OPTIONS" always;
    add_header Access-Control-Allow-Headers "Origin, Content-Type, Accept" always;

    # Handle OPTIONS requests
    if ($request_method = OPTIONS) {
        return 204;
    }

    # JSON content type
    location ~ \.json$ {
        add_header Content-Type "application/json" always;
    }

    # Caching
    location ~* \.(json)$ {
        expires 5m;
        add_header Cache-Control "public";
    }

    # Gzip compression
    gzip on;
    gzip_types application/json text/plain text/html;

    # Default to index.html
    location / {
        try_files $uri $uri/ /index.html;
    }
}
