<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChittyOS System Architecture</title>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .architecture-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .flow-line {
            stroke: #10b981;
            stroke-width: 2;
            fill: none;
            stroke-dasharray: 5,5;
            animation: flow 2s linear infinite;
        }
        @keyframes flow {
            0% { stroke-dashoffset: 0; }
            100% { stroke-dashoffset: 10; }
        }
        .component-box {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .component-box:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        .auth-layer {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            opacity: 0.8;
        }
        .data-layer {
            background: linear-gradient(45deg, #48cae4, #023e8a);
            opacity: 0.8;
        }
        .service-layer {
            background: linear-gradient(45deg, #06ffa5, #00b4db);
            opacity: 0.8;
        }
        .ui-layer {
            background: linear-gradient(45deg, #667eea, #764ba2);
            opacity: 0.8;
        }
        .pipeline-flow {
            stroke: #f59e0b;
            stroke-width: 3;
            fill: none;
            marker-end: url(#arrowhead);
        }
        .oauth-flow {
            stroke: #ef4444;
            stroke-width: 2;
            fill: none;
            stroke-dasharray: 8,4;
            marker-end: url(#arrowhead-red);
        }
        .mcp-flow {
            stroke: #8b5cf6;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead-purple);
        }
        .detail-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(20px);
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
        }
        .detail-panel.open {
            right: 0;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0.5rem 0;
        }
        .legend-line {
            width: 30px;
            height: 2px;
            margin-right: 10px;
        }
    </style>
</head>
<body class="architecture-container">
    <!-- Header -->
    <div class="p-6 text-center">
        <h1 class="text-4xl font-bold text-white mb-2">ChittyOS System Architecture</h1>
        <p class="text-xl text-white/80">Complete System Map with Pipelines, Flows & Authorization</p>
    </div>

    <!-- Main Architecture Diagram -->
    <div class="relative w-full h-screen overflow-hidden">
        <svg id="architecture-svg" class="w-full h-full" viewBox="0 0 1600 1200">
            <!-- Definitions for arrows and patterns -->
            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7"
                 refX="10" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b" />
                </marker>
                <marker id="arrowhead-red" markerWidth="10" markerHeight="7"
                 refX="10" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444" />
                </marker>
                <marker id="arrowhead-purple" markerWidth="10" markerHeight="7"
                 refX="10" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#8b5cf6" />
                </marker>
                <pattern id="grid" width="50" height="50" patternUnits="userSpaceOnUse">
                    <path d="M 50 0 L 0 0 0 50" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>
                </pattern>
            </defs>

            <!-- Grid Background -->
            <rect width="100%" height="100%" fill="url(#grid)" />

            <!-- Architecture Layers -->
            <!-- UI Layer -->
            <rect x="50" y="50" width="1500" height="150" class="ui-layer glass" rx="15" opacity="0.3"/>
            <text x="800" y="30" text-anchor="middle" fill="white" font-size="20" font-weight="bold">UI Layer</text>

            <!-- Service Layer -->
            <rect x="50" y="250" width="1500" height="200" class="service-layer glass" rx="15" opacity="0.3"/>
            <text x="800" y="230" text-anchor="middle" fill="white" font-size="20" font-weight="bold">Service Layer</text>

            <!-- Authorization Layer -->
            <rect x="50" y="500" width="1500" height="150" class="auth-layer glass" rx="15" opacity="0.3"/>
            <text x="800" y="480" text-anchor="middle" fill="white" font-size="20" font-weight="bold">Authorization Layer</text>

            <!-- Data Layer -->
            <rect x="50" y="700" width="1500" height="200" class="data-layer glass" rx="15" opacity="0.3"/>
            <text x="800" y="680" text-anchor="middle" fill="white" font-size="20" font-weight="bold">Data Layer</text>

            <!-- UI Components -->
            <g class="component-box" data-component="dashboard" onclick="showDetails('dashboard')">
                <rect x="100" y="80" width="180" height="100" class="glass" rx="10" fill="rgba(103, 126, 234, 0.8)"/>
                <text x="190" y="120" text-anchor="middle" fill="white" font-weight="bold">ChittyOS Dashboard</text>
                <text x="190" y="140" text-anchor="middle" fill="white" font-size="12">index.html</text>
            </g>

            <g class="component-box" data-component="dashboard-v2" onclick="showDetails('dashboard-v2')">
                <rect x="320" y="80" width="180" height="100" class="glass" rx="10" fill="rgba(103, 126, 234, 0.8)"/>
                <text x="410" y="120" text-anchor="middle" fill="white" font-weight="bold">Unified Dashboard</text>
                <text x="410" y="140" text-anchor="middle" fill="white" font-size="12">dashboard-v2.html</text>
            </g>

            <g class="component-box" data-component="registry-dashboard" onclick="showDetails('registry-dashboard')">
                <rect x="540" y="80" width="180" height="100" class="glass" rx="10" fill="rgba(103, 126, 234, 0.8)"/>
                <text x="630" y="120" text-anchor="middle" fill="white" font-weight="bold">Service Registry</text>
                <text x="630" y="140" text-anchor="middle" fill="white" font-size="12">service-registry-dashboard.html</text>
            </g>

            <!-- Service Components -->
            <g class="component-box" data-component="workers-ai" onclick="showDetails('workers-ai')">
                <rect x="100" y="290" width="200" height="120" class="glass" rx="10" fill="rgba(6, 255, 165, 0.8)"/>
                <text x="200" y="335" text-anchor="middle" fill="white" font-weight="bold">Workers AI AutoRAG</text>
                <text x="200" y="355" text-anchor="middle" fill="white" font-size="12">src/workers-ai-autorag.js</text>
                <text x="200" y="375" text-anchor="middle" fill="white" font-size="10">Registry • OAuth • Docs</text>
            </g>

            <g class="component-box" data-component="session-sync" onclick="showDetails('session-sync')">
                <rect x="350" y="290" width="180" height="120" class="glass" rx="10" fill="rgba(6, 255, 165, 0.8)"/>
                <text x="440" y="335" text-anchor="middle" fill="white" font-weight="bold">Session Sync</text>
                <text x="440" y="355" text-anchor="middle" fill="white" font-size="12">session-sync.js</text>
                <text x="440" y="375" text-anchor="middle" fill="white" font-size="10">Session Management</text>
            </g>

            <g class="component-box" data-component="data-service" onclick="showDetails('data-service')">
                <rect x="580" y="290" width="180" height="120" class="glass" rx="10" fill="rgba(6, 255, 165, 0.8)"/>
                <text x="670" y="335" text-anchor="middle" fill="white" font-weight="bold">Data Service</text>
                <text x="670" y="355" text-anchor="middle" fill="white" font-size="12">data-service.js</text>
                <text x="670" y="375" text-anchor="middle" fill="white" font-size="10">Local API Server</text>
            </g>

            <g class="component-box" data-component="mcp-servers" onclick="showDetails('mcp-servers')">
                <rect x="810" y="290" width="180" height="120" class="glass" rx="10" fill="rgba(139, 92, 246, 0.8)"/>
                <text x="900" y="335" text-anchor="middle" fill="white" font-weight="bold">MCP Servers</text>
                <text x="900" y="355" text-anchor="middle" fill="white" font-size="12">External Integrations</text>
                <text x="900" y="375" text-anchor="middle" fill="white" font-size="10">Model Context Protocol</text>
            </g>

            <g class="component-box" data-component="ai-services" onclick="showDetails('ai-services')">
                <rect x="1040" y="290" width="180" height="120" class="glass" rx="10" fill="rgba(6, 255, 165, 0.8)"/>
                <text x="1130" y="320" text-anchor="middle" fill="white" font-weight="bold">AI Services</text>
                <text x="1130" y="340" text-anchor="middle" fill="white" font-size="10">Claude • GPT • Gemini</text>
                <text x="1130" y="360" text-anchor="middle" fill="white" font-size="10">Notion • Workers AI</text>
                <text x="1130" y="380" text-anchor="middle" fill="white" font-size="10">AutoRAG • Vector DB</text>
            </g>

            <!-- Authorization Components -->
            <g class="component-box" data-component="oauth-provider" onclick="showDetails('oauth-provider')">
                <rect x="100" y="520" width="300" height="100" class="glass" rx="10" fill="rgba(255, 107, 107, 0.8)"/>
                <text x="250" y="560" text-anchor="middle" fill="white" font-weight="bold">OAuth 2.0 Provider</text>
                <text x="250" y="580" text-anchor="middle" fill="white" font-size="12">mcp-auth-integration.js</text>
                <text x="250" y="600" text-anchor="middle" fill="white" font-size="10">Authorization • Token Validation</text>
            </g>

            <g class="component-box" data-component="mcp-auth" onclick="showDetails('mcp-auth')">
                <rect x="450" y="520" width="200" height="100" class="glass" rx="10" fill="rgba(255, 107, 107, 0.8)"/>
                <text x="550" y="560" text-anchor="middle" fill="white" font-weight="bold">MCP Auth</text>
                <text x="550" y="580" text-anchor="middle" fill="white" font-size="12">Client Registration</text>
                <text x="550" y="600" text-anchor="middle" fill="white" font-size="10">Scope Management</text>
            </g>

            <g class="component-box" data-component="permission-engine" onclick="showDetails('permission-engine')">
                <rect x="700" y="520" width="200" height="100" class="glass" rx="10" fill="rgba(255, 107, 107, 0.8)"/>
                <text x="800" y="560" text-anchor="middle" fill="white" font-weight="bold">Permission Engine</text>
                <text x="800" y="580" text-anchor="middle" fill="white" font-size="12">RBAC • Scopes</text>
                <text x="800" y="600" text-anchor="middle" fill="white" font-size="10">chittyos:read/write/admin</text>
            </g>

            <!-- Data Storage Components -->
            <g class="component-box" data-component="kv-storage" onclick="showDetails('kv-storage')">
                <rect x="100" y="730" width="180" height="120" class="glass" rx="10" fill="rgba(72, 202, 228, 0.8)"/>
                <text x="190" y="775" text-anchor="middle" fill="white" font-weight="bold">KV Storage</text>
                <text x="190" y="795" text-anchor="middle" fill="white" font-size="12">Cloudflare KV</text>
                <text x="190" y="815" text-anchor="middle" fill="white" font-size="10">Tokens • Clients • Sessions</text>
            </g>

            <g class="component-box" data-component="evidence-files" onclick="showDetails('evidence-files')">
                <rect x="320" y="730" width="180" height="120" class="glass" rx="10" fill="rgba(72, 202, 228, 0.8)"/>
                <text x="410" y="775" text-anchor="middle" fill="white" font-weight="bold">Evidence Files</text>
                <text x="410" y="795" text-anchor="middle" fill="white" font-size="12">File System</text>
                <text x="410" y="815" text-anchor="middle" fill="white" font-size="10">Logs • Documents • Data</text>
            </g>

            <g class="component-box" data-component="vector-db" onclick="showDetails('vector-db')">
                <rect x="540" y="730" width="180" height="120" class="glass" rx="10" fill="rgba(72, 202, 228, 0.8)"/>
                <text x="630" y="775" text-anchor="middle" fill="white" font-weight="bold">Vector Database</text>
                <text x="630" y="795" text-anchor="middle" fill="white" font-size="12">Cloudflare Vectorize</text>
                <text x="630" y="815" text-anchor="middle" fill="white" font-size="10">Embeddings • Search</text>
            </g>

            <g class="component-box" data-component="notion-db" onclick="showDetails('notion-db')">
                <rect x="760" y="730" width="180" height="120" class="glass" rx="10" fill="rgba(72, 202, 228, 0.8)"/>
                <text x="850" y="775" text-anchor="middle" fill="white" font-weight="bold">Notion Database</text>
                <text x="850" y="795" text-anchor="middle" fill="white" font-size="12">External Storage</text>
                <text x="850" y="815" text-anchor="middle" fill="white" font-size="10">Sessions • Evidence</text>
            </g>

            <g class="component-box" data-component="blockchain" onclick="showDetails('blockchain')">
                <rect x="980" y="730" width="180" height="120" class="glass" rx="10" fill="rgba(72, 202, 228, 0.8)"/>
                <text x="1070" y="775" text-anchor="middle" fill="white" font-weight="bold">ChittyChain</text>
                <text x="1070" y="795" text-anchor="middle" fill="white" font-size="12">Blockchain</text>
                <text x="1070" y="815" text-anchor="middle" fill="white" font-size="10">Activity • Audit Trail</text>
            </g>

            <!-- Data Flow Lines -->
            <!-- UI to Services -->
            <path d="M 190 180 L 200 290" class="pipeline-flow"/>
            <path d="M 410 180 L 440 290" class="pipeline-flow"/>
            <path d="M 630 180 L 670 290" class="pipeline-flow"/>

            <!-- Services to Auth -->
            <path d="M 200 410 L 250 520" class="pipeline-flow"/>
            <path d="M 440 410 L 550 520" class="pipeline-flow"/>
            <path d="M 670 410 L 800 520" class="pipeline-flow"/>

            <!-- Services to Data -->
            <path d="M 200 410 L 190 730" class="pipeline-flow"/>
            <path d="M 440 410 L 410 730" class="pipeline-flow"/>
            <path d="M 670 410 L 630 730" class="pipeline-flow"/>

            <!-- OAuth Flows -->
            <path d="M 400 570 L 900 350" class="oauth-flow"/>
            <path d="M 250 620 L 190 730" class="oauth-flow"/>

            <!-- MCP Integration Flows -->
            <path d="M 810 350 L 550 520" class="mcp-flow"/>
            <path d="M 900 410 L 900 520" class="mcp-flow"/>

            <!-- External API Flows -->
            <path d="M 1130 410 L 850 730" class="flow-line"/>
            <path d="M 1130 410 L 1070 730" class="flow-line"/>

        </svg>
    </div>

    <!-- Legend -->
    <div class="fixed bottom-4 left-4 glass rounded-lg p-4 text-white">
        <h3 class="font-bold mb-2">Legend</h3>
        <div class="legend-item">
            <div class="legend-line pipeline-flow"></div>
            <span class="text-sm">Data Pipeline</span>
        </div>
        <div class="legend-item">
            <div class="legend-line oauth-flow"></div>
            <span class="text-sm">OAuth Flow</span>
        </div>
        <div class="legend-item">
            <div class="legend-line mcp-flow"></div>
            <span class="text-sm">MCP Integration</span>
        </div>
        <div class="legend-item">
            <div class="legend-line flow-line"></div>
            <span class="text-sm">Service Flow</span>
        </div>
    </div>

    <!-- Controls -->
    <div class="fixed top-4 right-4 space-x-2">
        <button onclick="toggleLayer('ui')" class="glass px-4 py-2 text-white rounded-lg hover:bg-white/20">UI Layer</button>
        <button onclick="toggleLayer('service')" class="glass px-4 py-2 text-white rounded-lg hover:bg-white/20">Services</button>
        <button onclick="toggleLayer('auth')" class="glass px-4 py-2 text-white rounded-lg hover:bg-white/20">Auth</button>
        <button onclick="toggleLayer('data')" class="glass px-4 py-2 text-white rounded-lg hover:bg-white/20">Data</button>
    </div>

    <!-- Detail Panel -->
    <div id="detail-panel" class="detail-panel">
        <div class="p-6">
            <div class="flex justify-between items-center mb-4">
                <h2 id="detail-title" class="text-2xl font-bold text-white"></h2>
                <button onclick="closeDetails()" class="text-white hover:text-gray-300">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>
            <div id="detail-content" class="text-white space-y-4"></div>
        </div>
    </div>

    <script>
        // Component details data
        const componentDetails = {
            'dashboard': {
                title: 'ChittyOS Dashboard',
                content: `
                    <h3 class="text-lg font-semibold mb-2">Main Command Center</h3>
                    <p class="mb-3">Primary dashboard interface for ChittyOS system monitoring and control.</p>

                    <h4 class="font-semibold mb-1">Features:</h4>
                    <ul class="list-disc list-inside mb-3 space-y-1">
                        <li>Real-time system status monitoring</li>
                        <li>AI session management (Claude, GPT, Gemini)</li>
                        <li>Evidence file tracking and visualization</li>
                        <li>Activity logging and audit trails</li>
                        <li>ChittyChain blockchain integration</li>
                    </ul>

                    <h4 class="font-semibold mb-1">API Endpoints:</h4>
                    <ul class="list-disc list-inside mb-3 space-y-1">
                        <li>/api/status - System status</li>
                        <li>/api/evidence - Evidence files</li>
                        <li>/api/activity - Recent activity</li>
                        <li>/api/metrics - Performance metrics</li>
                    </ul>

                    <h4 class="font-semibold mb-1">Technology Stack:</h4>
                    <ul class="list-disc list-inside space-y-1">
                        <li>Vanilla JavaScript</li>
                        <li>Tailwind CSS</li>
                        <li>Chart.js for visualizations</li>
                        <li>Lucide icons</li>
                    </ul>
                `
            },
            'workers-ai': {
                title: 'Workers AI AutoRAG',
                content: `
                    <h3 class="text-lg font-semibold mb-2">Core AI & Registry Service</h3>
                    <p class="mb-3">Central Cloudflare Worker handling AI queries, service registry, and OAuth authorization.</p>

                    <h4 class="font-semibold mb-1">Key Capabilities:</h4>
                    <ul class="list-disc list-inside mb-3 space-y-1">
                        <li>AutoRAG with Vectorize database</li>
                        <li>Service registry management</li>
                        <li>OAuth 2.0 authorization provider</li>
                        <li>Dynamic API documentation</li>
                        <li>MCP server integration</li>
                    </ul>

                    <h4 class="font-semibold mb-1">Endpoints:</h4>
                    <ul class="list-disc list-inside mb-3 space-y-1">
                        <li>/api/autorag - AI query processing</li>
                        <li>/api/registry - Service registry</li>
                        <li>/oauth/authorize - OAuth authorization</li>
                        <li>/oauth/token - Token exchange</li>
                        <li>/docs/* - Dynamic documentation</li>
                    </ul>

                    <h4 class="font-semibold mb-1">Data Flows:</h4>
                    <ul class="list-disc list-inside space-y-1">
                        <li>Processes AutoRAG queries from dashboards</li>
                        <li>Manages service registration requests</li>
                        <li>Handles OAuth flows for MCP servers</li>
                        <li>Generates real-time documentation</li>
                    </ul>
                `
            },
            'oauth-provider': {
                title: 'OAuth 2.0 Provider',
                content: `
                    <h3 class="text-lg font-semibold mb-2">Authorization Server</h3>
                    <p class="mb-3">Implements OAuth 2.0 authorization server following Cloudflare MCP patterns.</p>

                    <h4 class="font-semibold mb-1">Authorization Flow:</h4>
                    <ol class="list-decimal list-inside mb-3 space-y-1">
                        <li>Client requests authorization URL</li>
                        <li>User redirected to /oauth/authorize</li>
                        <li>User grants permissions</li>
                        <li>Authorization code returned to client</li>
                        <li>Client exchanges code for access token</li>
                        <li>Token used for API requests</li>
                    </ol>

                    <h4 class="font-semibold mb-1">Supported Scopes:</h4>
                    <ul class="list-disc list-inside mb-3 space-y-1">
                        <li>chittyos:read - Read access to registry/services</li>
                        <li>chittyos:write - Write access to register services</li>
                        <li>chittyos:admin - Administrative access</li>
                        <li>mcp:server - MCP server registration</li>
                    </ul>

                    <h4 class="font-semibold mb-1">Security Features:</h4>
                    <ul class="list-disc list-inside space-y-1">
                        <li>PKCE support for public clients</li>
                        <li>JWT token validation</li>
                        <li>Scope-based permissions</li>
                        <li>Token expiration and refresh</li>
                    </ul>
                `
            },
            'mcp-servers': {
                title: 'MCP Servers',
                content: `
                    <h3 class="text-lg font-semibold mb-2">Model Context Protocol Integration</h3>
                    <p class="mb-3">External MCP servers that integrate with ChittyOS via OAuth authorization.</p>

                    <h4 class="font-semibold mb-1">Integration Pattern:</h4>
                    <ol class="list-decimal list-inside mb-3 space-y-1">
                        <li>Register MCP server via dashboard</li>
                        <li>Receive OAuth credentials</li>
                        <li>Implement authorization flow</li>
                        <li>Access ChittyOS APIs with token</li>
                        <li>Provide tools and resources to Claude</li>
                    </ol>

                    <h4 class="font-semibold mb-1">Example Servers:</h4>
                    <ul class="list-disc list-inside mb-3 space-y-1">
                        <li>ChittyOS Filesystem MCP</li>
                        <li>Evidence Search MCP</li>
                        <li>AutoRAG Query MCP</li>
                        <li>Service Registry MCP</li>
                    </ul>

                    <h4 class="font-semibold mb-1">Capabilities:</h4>
                    <ul class="list-disc list-inside space-y-1">
                        <li>Access ChittyOS evidence files</li>
                        <li>Query AutoRAG knowledge base</li>
                        <li>Register new services</li>
                        <li>Monitor system metrics</li>
                    </ul>
                `
            },
            'kv-storage': {
                title: 'KV Storage',
                content: `
                    <h3 class="text-lg font-semibold mb-2">Cloudflare Key-Value Storage</h3>
                    <p class="mb-3">Distributed storage for OAuth tokens, client credentials, and session data.</p>

                    <h4 class="font-semibold mb-1">Stored Data:</h4>
                    <ul class="list-disc list-inside mb-3 space-y-1">
                        <li>OAuth access tokens and refresh tokens</li>
                        <li>Client credentials and metadata</li>
                        <li>Authorization codes (temporary)</li>
                        <li>Session state and user preferences</li>
                        <li>Rate limiting counters</li>
                    </ul>

                    <h4 class="font-semibold mb-1">Key Patterns:</h4>
                    <ul class="list-disc list-inside mb-3 space-y-1">
                        <li>oauth:token:{token_id} - Access tokens</li>
                        <li>oauth:client:{client_id} - Client data</li>
                        <li>oauth:code:{code} - Authorization codes</li>
                        <li>session:{session_id} - User sessions</li>
                    </ul>

                    <h4 class="font-semibold mb-1">Features:</h4>
                    <ul class="list-disc list-inside space-y-1">
                        <li>Global edge distribution</li>
                        <li>Automatic TTL for temporary data</li>
                        <li>Atomic operations</li>
                        <li>Encryption at rest</li>
                    </ul>
                `
            }
        };

        // Show component details
        function showDetails(componentId) {
            const panel = document.getElementById('detail-panel');
            const title = document.getElementById('detail-title');
            const content = document.getElementById('detail-content');

            const details = componentDetails[componentId];
            if (details) {
                title.textContent = details.title;
                content.innerHTML = details.content;
                panel.classList.add('open');
            }
        }

        // Close details panel
        function closeDetails() {
            document.getElementById('detail-panel').classList.remove('open');
        }

        // Toggle layer visibility
        function toggleLayer(layer) {
            const layerClass = layer + '-layer';
            const elements = document.querySelectorAll('.' + layerClass);
            elements.forEach(el => {
                const currentOpacity = el.style.opacity || '0.3';
                el.style.opacity = currentOpacity === '0.3' ? '0.1' : '0.3';
            });
        }

        // Initialize Lucide icons
        lucide.createIcons();

        // Add click handlers for all component boxes
        document.querySelectorAll('.component-box').forEach(box => {
            box.addEventListener('click', function() {
                const componentId = this.getAttribute('data-component');
                showDetails(componentId);
            });
        });

        // Close detail panel when clicking outside
        document.addEventListener('click', function(e) {
            const panel = document.getElementById('detail-panel');
            const isClickInside = panel.contains(e.target) || e.target.closest('.component-box');

            if (!isClickInside && panel.classList.contains('open')) {
                closeDetails();
            }
        });

        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeDetails();
            }
        });
    </script>
</body>
</html>